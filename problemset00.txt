1)with highest_salary
as(SELECT NAME ,dense_rank() OVER (ORDER BY SALARY DESC)as dr1 FROM EMPLOYEE )
select name from highest_salary where dr1<=3;
		(OR)
	select name from employee e
	where 3 > ( Select count(salary) from employee
	where e.salary < salary )order by salary desc
	
	
2)select name,salary from employee where  salary in (select min(salary) from employee);
		(OR)
		with least_salary 
	as(select salary,name,dense_rank() over(order by salary)as lst1 from employee)
	select name,salary from least_salary where lst1=1;
	
	
3)select name from employee where managerid not in (select e_id from employee as e inner join DEPARTMENT as d
on e.name=d.dept_manager);


4)select name from employee where name in (select dept_manager from department);
						(OR)
	select name from employee as e inner join department d on e.name=d.dept_manager;

	
5)select name from employee where salary in (select min(salary) from employee as e inner join department d on 
e.name=d.dept_manager)
					(OR)
	with least as (select min(salary) as sal from employee group by managerid)
select min(sal) from least;


6)select count(name) from employee as e inner join department  as d on e.dept_id=d.dept_id where d.dep_name='communication';

7)select name,max(salary) from employee as e inner join department  as d on e.dept_id=d.dept_id where d.dep_name='FINANCE';

8)select name,min(salary) from employee as e inner join department  as d on e.dept_id=d.dept_id where d.dep_name='INSURANCE';

9)select max(salary),count(*) from employee as e inner join department d on e.dept_id=d.dept_id  where d.dep_name='HEALTH';

10)select name from employee where managerid in (select e.e_id from employee as e inner join 
department as d on e.name=d.dept_manager where d.dept_manager="NATASHA STEVENS");

11)select name,count(*),d.dep_name,d.dept_manager,count(*) from employee as e inner join department as d on e.dept_id =d.dept_id 
where d.dep_name = 'HEALTH';


12)select e.dept_id,e.e_id,e.managerid from employee as e inner join department as d 
on e.dept_id = d.dept_id where d.dep_name='COMMUNICATION'; 

13)select e.dept_id,d.dep_name,avg(salary) from employee as e inner join department as d on  e.dept_id=d.dept_id
group by dept_id;

14)select sum(salary) from employee where dept_id in(select dept_id from department where dep_name='finance');

15)with least_salary as (select e.dept_id,d.dep_name,d.dept_manager,dense_rank() over(order by sum(e.salary)) as least from employee e 
inner join department d on e.dept_id=d.dept_id group 
by e.dept_id)select dep_name,dept_id,dept_manager from least_salary where least=1;

16)select dept_id,count(name) as employee_count from employee group by dept_id;

17)select count(name),dept_id from employee where salary<10000 group by dept_id;

18)select count(*) from employee where dept_id = 'D04';

19)with least_sal as (select e.dept_id,d.dep_name,dense_rank() over(order by count(*) desc)as e from employee as e inner join department as d 
 on e.dept_id = d.dept_id group by dept_id)
select dept_id,dep_name from  least_sal where e=1;

20)select name from employee where managerid in (select e.e_id from employee as e inner join department as d
where e.dept_id=d.dept_id and d.dept_manager ="TIM ARCHER")
					
